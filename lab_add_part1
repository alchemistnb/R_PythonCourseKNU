### 1. Напишіть функцію prepare_set <- function(file_name) {} яка в якості аргументу приймає ім’я файлу і повертає дата фрейм. Збережіть цей дата фрейм в змінну olympics olympics <- prepare_set(“olympics.csv”)

```{r}

install.packages("stringr")

library("stringr")
prepare_set <- function(namefile) 
{
  df <- read.csv(namefile, skip = 1, header = TRUE, encoding = "UTF-8", stringsAsFactors = FALSE)

### 2. Першому стовпцю дати назву 'Country'

names(df)[1] <- "Country"

### 3. Автоматично в циклі згенерувати назви останніх стовпців за наступними правилами:
###3.1. Видалити з назви “X.U.2116..”, тобто “X.U.2116..Summer” буде “Summer”
###3.2. “X01..” замінити на “Gold”, тобто “ X01...1” буде “Gold.1”
###3.3. “X02..” та “X03..” замінити на “Silver” та “Bronze” відповідно
###В результаті повинні бути наступні назви стовпців: "Country", "Summer", "Gold", "Silver", "Bronze", "Total", "Winter", "Gold.1", "Silver.1", "Bronze.1", "Total.1", "Games", "Gold.2", "Silver.2", "Bronze.2", "Combined.total"

  nam <- names(df)
  for (i in 2:length(names(df))){ #конвер. довжини назви стовпця
    if (substr(nam[i],1,3) == "X.."){ #substr (x, start, stop) - заміна назви стов. на симв. вектор
      names(df)[i] <- substr(nam[i],4,nchar(nam[i]))
    } else if(substr(nam[i],1,2) == "X0"){
      n <- substr(nam[i],3,3)
      if (n == "1"){
        names(df)[i] <- paste0("Gold",substr(nam[i],6,nchar(nam[i])))
      } else if (n == "2"){
        names(df)[i] <- paste0("Silver",substr(nam[i],6,nchar(nam[i])))
      } else if (n == "3"){
        names(df)[i] <- paste0("Bronze",substr(nam[i],6,nchar(nam[i])))
      }
    }
  }

### 4. Необхідно привести назви країн до виду "Afghanistan", "Algeria" і т.п. Для цього можна використати функцію str_split бібліотеки stringr. В назві країн не повинно бути пробілів на початку та в кінці.
  splited <- str_split(df$Country," ")
  for (i in 1:length(splited)){ 
    df$Country[i] <- splited[[i]][1]
  }
  id <- vector()
  for(i in 1:length(df$Country)){
    id <- c(id,toupper(substr(df$Country[i],1,3)))
  }
### 5 Додайте до дата фрейму новий стовпець “ID”, в який запишіть трибуквений код країна. Наприклад, "AFG", "ALG" і т.п.

   df$ID <- id 

### 6 Видаліть з дата фрейму останню строку “Totals”
    df <- df[-dim(df)[1],]
  
    return (df)
  }
olympics <- prepare_set("olympics.csv")
olympics

#Для кожного наступного питання напишіть функцію, яка повертає вказаний результат. Назви функції “answer_one” для питання 1, “answer_two” для питання 2 і т.д.

## Питання 1 Котра країна виграла найбільшу кількість золотих нагород на літніх іграх? Функція повинна повернути одне текстове значення.

answer_one <- olympics$Country[which.max(olympics$Gold)]
answer_one

## Питання 2 Яка країна має найбільшу різницю між кількістю нагород на літніх та зимових іграх? Функція повинна повернути одне текстове значення.

answer_two <- olympics$Country[which.max(abs(olympics$Total - olympics$Total.1))]
answer_two

## Питання 3 В якій крайні найбільша різниця між літніми та зимовими золотими нагородами відносно до загальної кількості нагород (Summer Gold - Winter Gold) / Total Gold. Врахувати тільки країни які мають як мінімум по одній нагороді в літніх та зимових іграх. Функція повинна повернути одне текстове значення.

##На жаль, не вийшло :( 

### Питання 4 Необхідно знайти кількість балів по кожній крайні. Бали рахуються наступним чином: Золота нагорода Gold.2 це три бали, срібна Silver.2 - 2 бали та бронзова Bronze.2 – 1 бал. Функція повинна повертати дата фрейм довжиною 146, який складається з двох колонок: "Country", "Points".

scores <- apply(olympics[,13:15],1,function (x) x[1]*3 + x[2]*2 + x[3]*1)
answer_four <- data.frame(Country = olympics$Country,Points = scores)
answer_four



```
